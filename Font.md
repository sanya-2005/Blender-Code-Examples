# ДОКУМЕНТАЦИЯ ПО BLF (МОДУЛУ ПО РАБОТЕ СО ШРИФТАМИ) <br />
Модуль BLF позволяет отрисовывать текст, и очень вероятно будет являться постоянным спутником, когда дело дойдет до кастомной отрисовки во вьюпорте/любом другом редакторе
<br />
Модуль работает по принципу "настроил-отрисовал", и так для каждой отдельной строки. Сначала вы задаете шрифт, цвет, позицию строке, а потом используйте функцию ```draw()```
<br />
<br />
![](https://github.com/sanya-2005/Blender-Code-Examples/blob/main/images/blf.png)
<br />
Да, вы все верно поняли, blf **не умеет** рисовать несколько строк, только одна строка за раз.
<br />
Символ перехода на новую строку `\n` и другие иные способы отрисовать несколько строк за раз **не работают**. Далее, в том числе будет показано, как сделать это правильно

# Инициализация шрифта
Если вам хватает встроенного в блендер шрифта, то просто указывайте везде `font_id` как 0, и пропускайте главу
<br />
blf можно указать, чтобы она использовала ваш шрифт, который находится в файле со шрифтом (ttf например)
<br />
Для этого необходимо загрузить шрифт при помощи `blf.load()`. Функция вернет число, которое будет ID шрифта. При помощи ID можно будет обращаться к загруженному шрифту в функциях blf
<br />
ID стоит сохранить в глобальную переменную, так как если потерять ID, то потеряется доступ ко шрифту
<br />
```python
import blf

# переменная для id шрифта
font_id = 0

# путь до шрифта должен быть абсолютным (то есть прямо от диска). 
# У блендера в модуле bpy есть функции для преобразования относительного пути от текущего blend файла в абсолютный путь
# а путь до скрипта можно получить через системные библиотеки питона
font_id = blf.load("путь до шрифта")
```
Наш шрифт загружен, теперь можно переходить к его использованию

# Работа с blf
Собственно, основной раздел. Напоминаю, если не нужен свой шрифт, просто ставите аргументу `font_id` 0
<br />
Для начала стоит установить шрифту местоположение. Координаты отсчитываются от нижнего левого угла редактора, там будет 0 по x, и по y
```python
blf.position(font_id, 0, context.area.height - 200, 0)
```
Первый аргумент - id шрифта, для которого настраиваем положение. Далее идут сами координаты, то есть x, y и внимание! - z. Ее можно игнорировать, в моем примере она не будет ни на что влиять
<br />
Еще мы можем настроить например размер и цвет шрифта
```python
blf.size(font_id, 24)
blf.color(font_id, 1, 1, 1, 1)
```
Помимо основных настроек вроде цвета и размера есть дополнительные, например тень от шрифта, или вращение строки. В документации можно найти их полный перечень https://docs.blender.org/api/current/blf.html
<br /> 
Когда шрифт настроен, можно начать рисовать текст. Как говорилось ранее, за саму отрисовку отвечает `blf.draw()`. В нее необходимо передать id шрифта, и строку, которую необходимо отобразить
```python
blf.draw(font_id, "hello world")
```
Ранее также говорилось, что blf не умеет отрисовывать несколько строк за раз. Если попробовать вставить символ `\n`, или вызвать сразу второй `draw()`, то строки отрисуются вместе, или наложенными друг на друга
<br />
На самом деле, рисовать несколько строк довольно просто. Я говорил ранее, что blf работает по принципу настроил-отрисовал. Положение - точно такая же настройка шрифта. И чтобы отрисовать новую строку, нужно изменить положение по y для второй строки. Хотя бы просто добавить к текущей позиции размер шрифта, и только потом вызвать `draw()` для новой строки
```python
blf.draw(font_id, "string 1")

blf.position(font_id, 0, context.area.height - (200 + 24), 0)

blf.draw(font_id, "string 2")
```
# Регистрация функции-отрисовщика
Если вы сразу копировали код, и выполняли его в блендере, то наверняка увидели, что ничего не происходит: ошибок нет, но и на экране тоже ничего нет. Как же так!?
<br /> 
Проблема в том, что код нужно еще и зарегистрировать как хендлер-отрисовщик для окна, где должен показываться текст
<br />
Делается это путем помещения кода в специальную функцию, которая потом прикрепляется через класс редактора в `bpy.types`
```python
import bpy
import blf

font_id = 0
handler = None

def draw(self, context):
    blf.position(font_id, 500, 500, 0)
    blf.color(font_id, 1, 1, 1, 1)
    blf.size(font_id, 24)
    
    blf.draw(font_id, "my text")

handler = bpy.types.SpaceView3D.draw_handler_add(draw, (None, None), 'WINDOW', 'POST_PIXEL')
```
![результат](https://github.com/sanya-2005/Blender-Code-Examples/blob/main/images/blf_example.png)
Хендлер не удалится просто так даже при открытии нового файла или перезагрузке скриптов. Поэтому функция добавления хендлера возвращает объект при помощи которого можно будет удалить хендлер и убрать отрисовку
<br />
Если вы например случайно сохранили хендлер в локальную переменную, или иным способом его потеряли, то остается только перезагрузить блендер



